!function(e){e(document).ready(function(){e(".media-editor").on("click",".moveLeft, .moveRight",function(t){t.preventDefault();var i=e(this).parents(".media-editor__wrap");e(this).hasClass("moveLeft")?i.prev(".media-editor__wrap").before(i):i.next(".media-editor__wrap").after(i),i.parent(".media-editor__line").effect("highlight",{},500)}),e("#media-submit").click(function(t){if(t.preventDefault(),e(this).attr("disabled"))return!1;if(window.confirm("保存してよろしいですか？ この変更はすぐに反映されます。")){var i=[],a=[];if(e(".media-editor__line").each(function(t,n){var r=[];e(n).find(".media-editor__wrap").each(function(t,i){switch(e(i).attr("data-type")){case"broken":return a.push("無効な情報が含まれています。削除してください。"),!1;case"link":var n={};e(i).find(".media-editor__input").each(function(t,i){var a=e(i).val();e(i).attr("name");n[e(i).attr("name")]=a}),r.push(n)}}),i.push(r)}),a.length)window.alert(a.join("\n"));else{var n=e(this);e(this).attr("disabled",!0),e.post(e(this).attr("data-endpoint"),{data:i}).done(function(e){window.alert(e.message)}).fail(function(e){window.alert(e.responseJSON?e.responseJSON.message:"保存に失敗しました。")}).always(function(){n.attr("disabled",!1)})}}})})}(jQuery);