!function(a){"use strict";a(document).ready(function(){function e(){var e=a(".sk_match__status");a("input[name=match-should-delete]").val("del"),a("input[name=match-block-id]").val(""),e.empty(),e.append('<span class="sk_match__name--no">指定なし</span>')}function t(e){a("input[name=match-should-delete]").val(""),a("input[name=match-block-id]").val(e.id),a("input[name=match-abroad]").val(e.abroad?1:0),a(".sk_match__status").empty().append('<span class="sk_match__name">'+e.label+'<a href="#">&times;</a></span>')}a(".sk_relation__input").each(function(e,t){var n=a(t).attr("id").replace("sk-relation-",""),s=function(e){setTimeout(function(){var t=a("#primary-"+n),s=t.val(),i=[];i.push(a('<option class="no-primary" value="0">選択しない</option>')),"0"===s&&(i[0].selected=!0);var c=a("#sk-relation-"+n).tokenInput("get");c.forEach(function(e){var t=a('<option value="'+e.id+'">'+e.name+"</option>");i.push(t)}),t.empty().append(i),1===c.length&&"0"===s&&e&&(s=c[0].id),t.val(s),t.trigger("change")},100)};a(t).tokenInput(a(t).attr("data-endpoint"),{prePopulate:window.SkRelation[a(t).attr("data-type")],theme:"facebook",preventDuplicates:!0,onReady:function(){s(!1)},onAdd:function(){s(!0)},onDelete:function(){s(!0)}})}),a("input[name=sk-search-abroad]:radio").change(function(){switch(a(this).val()){case"0":a(".sk-search__paragraph.league-japan").removeClass("hidden"),a(".sk-search__paragraph.league-world").addClass("hidden");break;case"1":a(".sk-search__paragraph.league-japan").addClass("hidden"),a(".sk-search__paragraph.league-world").removeClass("hidden")}});var n=a("#sk-match-dialog").dialog({autoOpen:!1,modal:!0,width:420,buttons:{"探す":function(){var e=n.find("input[name=sk-search-text]").val(),s=n.find("input[name=sk-search-abroad]:checked").val(),i=n.find("select[name=sk-search-year]").val(),c=n.find("select[name=sk-search-month]").val(),r=n.find("select[name=sk-search-day]").val(),l=n.find("input[name=sk-search-league]:checked").val();return i&&c?(a(this).find(".sk-search__result").empty().append('<li class="sk-search__item--loading">検索中……（最大20件）</li>'),void a.get(a(this).attr("data-endpoint"),{action:"sk_match_search",s:e,abroad:s,year:i,month:c,day:r,league:l}).done(function(e){var s=n.find(".sk-search__result");s.empty(),e.length?a.each(e,function(e,s){var i=a('<li class="sk-search__item"><a class="sk-search__fix button">決定</a><span class="sk_search__item--title"></span></li>');i.find("span").html(s.label),i.on("click","a",function(a){a.preventDefault(),t(s),n.dialog("close")}),a(".sk-search__result").append(i)}):s.append('<p class="descriptipon" style="color: red; text-align: center;">見つかりませんでした。</p>')}).fail(function(){alert("検索に失敗しました。")})):(alert("年月を指定してください"),!1)},"キャンセル":function(){a(this).dialog("close")}}});a(".sk_match__open").click(function(a){a.preventDefault(),n.dialog("open")}),a(".sk_match__status").on("click","a",function(a){a.preventDefault(),e()});var s=function(){var e=[];["league","team","player"].forEach(function(t){var n=a('select[name="primary-'+t+'"]');parseInt(n.val())>0&&e.push(n.find("option:selected").text())}),e.length||e.push("カテゴリー"),e.push("記事名"),a("#sk-breadcrumb-preview").text(e.join(" > ")),a(".sk_content-structure").effect("highlight",{color:"#ff9"},1e3)};s(),a('input[name="tax_input[league][]"]').click(function(e){var t={};a("#taxonomy-league input:checked").each(function(e,n){t[n.value]=a(n).parent().text().trim()});var n=[];for(var i in t)Object.hasOwn(t,i)&&n.push({id:i,label:t[i]});1===n.length&&(a('select[name="primary-league"] option[value="'+n[0].id+'"]').attr("selected",!0),s())}),a("#primary-team, #primary-player").change(function(){s()}),a("#sk-breadcrumb-changer").click(function(e){e.preventDefault(),a(".sk_content-structure-body").toggleClass("is-open")})})}(jQuery);