!function(e){"use strict";e(document).ready(function(){function n(){var n=r.find("li").length;n?r.removeClass("sk_recommends__list--empty"):r.addClass("sk_recommends__list--empty"),r.find("li").each(function(n,t){e(t).find("input").each(function(t,i){e(i).attr("name",e(i).attr("name").replace(/\[[0-9]+]/,function(){return"["+n+"]"}))})})}function t(){return e(e(".sk_recommends__tpl").html()).appendTo(r).effect("highlight",{},500)}function i(){var n=o.find("li").length;n?o.removeClass("sk_recommends_image__list--empty"):o.addClass("sk_recommends_image__list--empty"),o.find("li").each(function(n,t){e(t).find("input").each(function(t,i){e(i).attr("name",e(i).attr("name").replace(/\[[0-9]+]/,function(){return"["+n+"]"}))})})}function c(){return e(e(".sk_recommends_image__tpl").html()).appendTo(o).effect("highlight",{},500)}var a=e(".sk_recommends"),r=a.find(".sk_recommends__list");e(".sk_recommends__search").each(function(i,c){e(c).autocomplete({source:e(c).attr("data-endpoint"),delay:1500,focus:function(){return!1},select:function(i,a){var r=t();return r.find(".sk_recommends__title").val(a.item.value),r.find(".sk_recommends__url").val(a.item.url),e(c).val(""),n(),!1}})}),e(".sk_recommends__auto").click(function(i){i.preventDefault(),e.get(e(this).attr("data-endpoint"),{action:"sk_recommend_auto"}).done(function(i){e.each(i,function(e,n){var i=t();i.find(".sk_recommends__title").val(n.title),i.find(".sk_recommends__url").val(n.url)}),n()}).fail(function(){window.alert("データの取得に失敗しました。")})}),e(".sk_recommends__add").click(function(e){e.preventDefault(),t(),n()}),a.on("click",".sk_recommends__delete",function(t){t.preventDefault(),e(this).parents("li").remove(),n()}),a.on("click",".sk_recommends__up",function(t){t.preventDefault();var i=e(this).parents("li"),c=i.prev("li");c.before(i),i.effect("highlight",{},500),n()}),a.on("click",".sk_recommends__down",function(t){t.preventDefault();var i=e(this).parents("li"),c=i.next("li");c.after(i),i.effect("highlight",{},500),n()});var _=e(".sk_recommends_image"),o=_.find(".sk_recommends_image__list");e(".sk_recommends_image__search").each(function(n,t){e(t).autocomplete({source:e(t).attr("data-endpoint"),delay:1500,focus:function(){return!1},select:function(n,a){var r=c();return r.find(".sk_recommends_image__title").val(a.item.value),r.find(".sk_recommends_image__url").val(a.item.url),e(t).val(""),i(),!1}})}),e(".sk_recommends_image__auto").click(function(n){n.preventDefault(),e.get(e(this).attr("data-endpoint"),{action:"sk_recommend_image_auto"}).done(function(n){e.each(n,function(e,n){var t=c();t.find(".sk_recommends_image__title").val(n.title),t.find(".sk_recommends_image__url").val(n.url)}),i()}).fail(function(){window.alert("データの取得に失敗しました。")})}),e(".sk_recommends_image__add").click(function(e){e.preventDefault(),c(),i()}),_.on("click",".sk_recommends_image__delete",function(n){n.preventDefault(),e(this).parents("li").remove(),i()}),_.on("click",".sk_recommends_image__up",function(n){n.preventDefault();var t=e(this).parents("li"),c=t.prev("li");c.before(t),t.effect("highlight",{},500),i()}),_.on("click",".sk_recommends_image__down",function(n){n.preventDefault();var t=e(this).parents("li"),c=t.next("li");c.after(t),t.effect("highlight",{},500),i()})})}(jQuery);